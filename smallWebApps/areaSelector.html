<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Area Selector</title>
    <style>
        body {
            background-color: #f1f1f1;
            font-family: Arial, Helvetica, sans-serif;
        }

        #content {
            text-align: center;
        }

        #board {
            width: fit-content;
            border: 1px solid black;
        }

        .row {
            display: flex;
            align-items: center;
        }

        .cell {
            width: 40px;
            height: 40px;
            border: 1px solid black;
        }

        .filled {
            background-color: aquamarine;
        }
    </style>
</head>

<body>
    <div id="content">
        <h3>Click & hold on a box and drag to select multiple boxes</h3>

        <div id="board"></div>
    </div>

    <script>
        const boardEle = document.getElementById("board");

        const WINDOW_WIDTH = window.innerWidth - 100, WINDOW_HEIGHT = window.innerHeight - 150;
        const CELL_DIMN = 40;
        const BOARD_DIMN_HEIGHT = Math.floor(WINDOW_HEIGHT / CELL_DIMN);
        const BOARD_DIMN_WIDTH = Math.floor(WINDOW_WIDTH / CELL_DIMN);
        const BOARD_OFFSET_LEFT = boardEle.offsetLeft, BOARD_OFFSET_TOP = boardEle.offsetTop;

        let isHolding = false;
        let timer;

        let startCursorPosInBoardX, startCursorPosInBoardY;
        let currCursorPosInBoardX, currCursorPosInBoardY;

        boardEle.addEventListener('mousedown', handleMouseDown);
        boardEle.addEventListener('mouseup', handleBoardMouseUp);
        boardEle.addEventListener("mousemove", handleBoardMouseMove);

        function handleMouseDown(e) {
            startCursorPosInBoardX = e.clientX - BOARD_OFFSET_LEFT;
            startCursorPosInBoardY = e.clientY - BOARD_OFFSET_TOP;

            timer = setTimeout(function() { isHolding = true; }, 200); // simulating hold event
        }

        function handleBoardMouseUp() {
            clearTimeout(timer);
            isHolding = false;

            startCursorPosInBoardX = undefined, startCursorPosInBoardY = undefined;
            currCursorPosInBoardX = undefined, currCursorPosInBoardY = undefined;
            renderBoard();
        }

        function handleBoardMouseMove(e) {
            if (isHolding) { // if mouse is hold and moved
                currCursorPosInBoardX = e.clientX - BOARD_OFFSET_LEFT;
                currCursorPosInBoardY = e.clientY - BOARD_OFFSET_TOP;

                renderBoard();
            }
        }


        renderBoard();
        function renderBoard() {
            const tempEle = document.createElement("div");

            for (let i = 0; i < BOARD_DIMN_HEIGHT; i++) {
                const rowEle = document.createElement("div");
                rowEle.classList.add("row");

                for (let j = 0; j < BOARD_DIMN_WIDTH; j++) {
                    const cellEle = document.createElement("div");
                    cellEle.classList.add("cell");

                    const thisCellPosX = ((j + 1) * CELL_DIMN), thisCellPosY = ((i + 1) * CELL_DIMN);
                    if (
                        (thisCellPosX >= startCursorPosInBoardX && thisCellPosX <= currCursorPosInBoardX) &&
                        (thisCellPosY >= startCursorPosInBoardY && thisCellPosY <= currCursorPosInBoardY)
                    ) cellEle.classList.add("filled");

                    rowEle.append(cellEle);
                }

                tempEle.append(rowEle);
            }

            boardEle.innerHTML = tempEle.innerHTML;
        }

        function debounce(func, delay) {
            let timer;

            return function(...args) {
                clearTimeout(timer);
                timer = setTimeout(() => {
                    func.call(this, ...args);
                }, delay);
            }
        }
    </script>
</body>

</html>