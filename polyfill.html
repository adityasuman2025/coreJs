<html> 
<body>
    <h3 >Polyfill</h3>

    <script>
        //bind
        let name = {
            firstName: "aditya",
            lastName: "suman",
        }

        function printName(state, country) {
            console.log(this.firstName + " " + this.lastName + " from " + state + ", " + country);
        }

        Function.prototype.myBind = function(obj, ...args) {
            const func = this;
            return function(...args2) {
                func.apply(obj, [...args, ...args2])
            }
        }

        const printMyName = printName.myBind(name, "delhi");
        printMyName("india")


        //map
        let arr = [1,2,3,4,5,6,7,8,9,0];
        Array.prototype.myMap = function(func) {
            let arr = this;

            let newArr = []
            for (let i = 0; i < arr.length; i++) {
                newArr[i] = func(arr[i], i);
            }

            return newArr;
        }

        const newArrByMap = arr.myMap((item, index) => { return item + index });
        console.log("newArrByMap", newArrByMap);


        //filter
        Array.prototype.myFilter = function(func) {
            let arr = this;

            let newArr = []
            for (let i = 0; i < arr.length; i++) {
                if (func(arr[i], i)) {
                    newArr.push(arr[i]);
                }
            }

            return newArr;
        }

        const newArrByFilter = arr.myFilter((item, index) => item%2 != 0);
        console.log("newArrByFilter", newArrByFilter);


        //reduce
        Array.prototype.myReduce = function(func, defaultValue) {
            let arr = this;
            let tempval = defaultValue;

            for (let i = 0; i < arr.length; i++) {
                tempval = func(tempval, arr[i], i)
            }

            return tempval;
        }

        const newArrByReduce = arr.myReduce((acc, item, index) => {
            acc[index] = item;
            return acc;
        }, {});


        //forEach
        Array.prototype.myForEach = function(func) {
            const arr = this;

            for (let i = 0; i < arr.length; i++) {
                func(arr[i], i)
            }
        }

        const newArrByForEach = arr.myForEach((item, index) => {
            console.log(index, item)
        });
        console.log("newArrByForEach", newArrByForEach);


        //find
        Array.prototype.myFind = function(func) {
            const arr = this;

            for (let i = 0; i < arr.length; i++) {
                if (func(arr[i], i)) {
                    return arr[i];
                }
            }
        }

        const newArrByFind = arr.myFind((item, index) => (item % 2 == 1) && (item > 3));
        console.log("newArrByFind", newArrByFind);

        
        //findIndex
        Array.prototype.myFindIndex = function(func) {
            const arr = this;

            for (let i = 0; i < arr.length; i++) {
                if (func(arr[i], i)) {
                    return i;
                }
            }
        }

        const newArrByFindIndex = arr.myFindIndex((item, index) => (item % 2 == 1) && (item > 3));
        console.log("newArrByFindIndex", newArrByFindIndex);


        //promise all
        Promise.myAll = function(arrayOfPromises) {
            let responses = [];
            let errResp = [];

            return new Promise((resolve, reject) => {
                try {
                    for (let i = 0; i < arrayOfPromises.length; i++) {
                        const thisPromise = arrayOfPromises[i];
                        thisPromise.then(resp => {
                            responses.push(resp);
                            if (i == (arrayOfPromises.length - 1)) {
                                if (errResp.length > 0) {
                                    reject(errResp)
                                } else {
                                    resolve("custom promise :: " + responses);
                                }
                            }
                        });
                    } 
                } catch(err) {
                    errResp.push(err);
                    reject(errResp);
                }                
            });
        }

        let p1 = Promise.resolve("promise 1");
        let p2 = new Promise ((resolve, reject) => {
            setTimeout(() => { resolve ("Promise 2 resolved after 2 seconds") }, 2000)
        });
        
        Promise.myAll([p1, p2])
        .then(res => {
            console.log("promise Response =>", res)
        })
        .catch(err => {
            console.log("promise error =>", err)
        });

    </script>
</body>
</html>